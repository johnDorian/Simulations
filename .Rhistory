det.fit(bc.fit1.F)
det.fit(bc.fit2.F)#
det.fit(bc.fit6.F)#
det.fit(bc.fit7.F)#
det.fit(bc.fit.fill.all.F)
plot(v.bc,bc.fit,main="fit.ranges=FALSE")
plot(v.bc,bc.fit7.T,main="fit.ranges=TRUE")
bc.fit1.T = fit.lmc(v.bc, g.bc,fit.ranges=TRUE,fit.lmc=TRUE,fit.method=1,warn.if.neg=TRUE)
bc.fit1.T = fit.lmc(v.bc, g.bc,fit.ranges=TRUE,fit.lmc=TRUE,fit.method=7,warn.if.neg=TRUE)
det.fit(bc.fit1.T)
?fit.lmc
bc.fit1.T = fit.lmc(v.bc, g.bc,fit.ranges=F,fit.lmc=F,fit.method=7,warn.if.neg=TRUE)
det.fit(bc.fit1.T)
?gstat
g.log = gstat(g.log,id="TP",model=vgm(log.tp.psill,"Sph",log.tp.range,log.tp.nug),max.dist=200)#
g.log = gstat(g.log,id="FLOW",model=vgm(log.flow.psill,"Sph",log.flow.range,log.flow.nug),max.dist=200)#
g.bc = gstat(g.bc,id="TP",model=vgm(bc.tp.psill,"Sph",bc.tp.range,bc.tp.nug),max.dist=200)#
g.bc = gstat(g.bc,id="FLOW",model=vgm(bc.flow.psill,"Sph",bc.flow.range,bc.flow.nug),max.dist=200)
 dataset#
g.log = gstat(NULL, "TP", log.spdf$TP ~ 1, log.spdf,,max.dist=200)#
g.log = gstat(g.log, "FLOW", log.spdf$FLOW ~ 1, log.spdf,max.dist=200)#
g.bc = gstat(NULL, "TP", bc.spdf$TP ~ 1, bc.spdf,,max.dist=200)#
g.bc = gstat(g.bc, "FLOW", bc.spdf$FLOW ~ 1, bc.spdf,max.dist=200)
g.log = gstat(NULL, "TP", log.spdf$TP ~ 1, log.spdf,,max.dist=200)
g.log = gstat(NULL, "TP", log.spdf$TP ~ 1, log.spdf,,maxdist=200)
g.log = gstat(g.log, "FLOW", log.spdf$FLOW ~ 1, log.spdf,maxdist=200)
g.bc = gstat(NULL, "TP", bc.spdf$TP ~ 1, bc.spdf,,maxdist=200)
g.bc = gstat(g.bc, "FLOW", bc.spdf$FLOW ~ 1, bc.spdf,maxdist=200)
g.log = gstat(g.log,id="FLOW",model=vgm(log.flow.psill,"Sph",log.flow.range,log.flow.nug),maxdist=200)
g.bc = gstat(g.bc,id="TP",model=vgm(bc.tp.psill,"Sph",bc.tp.range,bc.tp.nug),maxdist=200)
g.bc = gstat(g.bc,id="FLOW",model=vgm(bc.flow.psill,"Sph",bc.flow.range,bc.flow.nug),maxdist=200)
v.log.cloud = variogram(g.log,cloud=TRUE)
v.bc.cloud = variogram(g.bc,cloud=TRUE)
dummy.geodata<-as.geodata(data.log,coords.col=1:2,data.col=3)
dummy.var1<-variog(qual.tp.log,estimator.type="classical",option=c("cloud"))
dummy.var2<-variog(qual.tp.bc,estimator.type="classical",option=c("cloud"))
dummy.var1$u<-v.log.cloud$dist
dummy.var1$v<-v.log.cloud$gamma
dummy.var2$u<-v.bc.cloud$dist
dummy.var2$v<-v.bc.cloud$gamma
log<-variofit(dummy.var1,ini=c(0.5,0.5),cov.model="spherical",fix.nugget=F,max.dist=200,minimisation.function="nls")
bc<-variofit(dummy.var2,ini=c(0.5,27),cov.model="spherical", fix.nugget=F,minimisation.function="nls",weights="equal")
bc
g.log = gstat(g.log,id=c("TP","FLOW"),model=vgm(summary(log)$spatial.component[[1]][1], "Sph", log$practicalRange, log$nugget),maxdist=200)#
g.log.fill.all = gstat(g.log,id=c("TP","FLOW"),model=vgm(summary(log)$spatial.component[[1]][1], "Sph", log$practicalRange, log$nugget),fill.all=TRUE,,maxdist=200)#
g.bc = gstat(g.bc,id=c("TP","FLOW"),model=vgm(summary(bc)$spatial.component[[1]][1], "Sph", bc$practicalRange, bc$nugget),,maxdist=200)#
g.bc.fill.all = gstat(g.bc,id=c("TP","FLOW"),model=vgm(summary(bc)$spatial.component[[1]][1], "Sph", bc$practicalRange, bc$nugget),fill.all=TRUE,,maxdist=200)
log.fit=fit.lmc(v.log,g.log)#
log.fit1.T = fit.lmc(v.log, g.log,fit.ranges=TRUE,fit.lmc=FALSE,fit.method=1,warn.if.neg=TRUE)#
log.fit2.T = fit.lmc(v.log, g.log,fit.ranges=TRUE,fit.lmc=FALSE,fit.method=2,warn.if.neg=TRUE)#
log.fit6.T = fit.lmc(v.log, g.log,fit.ranges=TRUE,fit.lmc=FALSE,fit.method=6,warn.if.neg=TRUE)#
log.fit7.T = fit.lmc(v.log, g.log,fit.ranges=TRUE,fit.lmc=FALSE,fit.method=7,warn.if.neg=TRUE)#
log.fit.fill.all.T=fit.lmc(v.log,g.log.fill.all,fit.ranges=TRUE,fit.lmc=FALSE)#
log.fit1.F = fit.lmc(v.log, g.log,fit.ranges=FALSE,fit.lmc=FALSE,fit.method=1,warn.if.neg=TRUE)#
log.fit2.F = fit.lmc(v.log, g.log,fit.ranges=FALSE,fit.lmc=FALSE,fit.method=2,warn.if.neg=TRUE)#
log.fit6.F = fit.lmc(v.log, g.log,fit.ranges=FALSE,fit.lmc=FALSE,fit.method=6,warn.if.neg=TRUE)#
log.fit7.F = fit.lmc(v.log, g.log,fit.ranges=FALSE,fit.lmc=FALSE,fit.method=7,warn.if.neg=TRUE)#
log.fit.fill.all.F=fit.lmc(v.log,g.log.fill.all,fit.ranges=FALSE,fit.lmc=FALSE)#
det.fit(log.fit)#
det.fit(log.fit1.T)#
det.fit(log.fit2.T)#
det.fit(log.fit6.T)#
det.fit(log.fit7.T)#
det.fit(log.fit.fill.all.T)#
det.fit(log.fit1.F)#
det.fit(log.fit2.F)#
det.fit(log.fit6.F)#
det.fit(log.fit7.F)#
det.fit(log.fit.fill.all.F)
plot(v.log,log.fit,main="fit.ranges=FALSE")
plot(v.log,log.fit7.T,main="fit.ranges=TRUE")
bc.fit=fit.lmc(v.bc,g.bc)#
bc.fit1.T = fit.lmc(v.bc, g.bc,fit.ranges=TRUE,fit.lmc=FALSE,fit.method=1,warn.if.neg=TRUE)#
bc.fit2.T = fit.lmc(v.bc, g.bc,fit.ranges=TRUE,fit.lmc=FALSE,fit.method=2,warn.if.neg=TRUE)#
bc.fit6.T = fit.lmc(v.bc, g.bc,fit.ranges=TRUE,fit.lmc=FALSE,fit.method=6,warn.if.neg=TRUE)#
bc.fit7.T = fit.lmc(v.bc, g.bc,fit.ranges=TRUE,fit.lmc=FALSE,fit.method=7,warn.if.neg=TRUE)#
bc.fit.fill.all.T=fit.lmc(v.bc,g.bc.fill.all,fit.ranges=TRUE,fit.lmc=FALSE)#
bc.fit1.F = fit.lmc(v.bc, g.bc,fit.ranges=FALSE,fit.lmc=FALSE,fit.method=1,warn.if.neg=TRUE)#
bc.fit2.F = fit.lmc(v.bc, g.bc,fit.ranges=FALSE,fit.lmc=FALSE,fit.method=2,warn.if.neg=TRUE)#
bc.fit6.F = fit.lmc(v.bc, g.bc,fit.ranges=FALSE,fit.lmc=FALSE,fit.method=6,warn.if.neg=TRUE)#
bc.fit7.F = fit.lmc(v.bc, g.bc,fit.ranges=FALSE,fit.lmc=FALSE,fit.method=7,warn.if.neg=TRUE)#
bc.fit.fill.all.F=fit.lmc(v.bc,g.bc.fill.all,fit.ranges=FALSE,fit.lmc=FALSE)#
det.fit(bc.fit)#
det.fit(bc.fit1.T)#
det.fit(bc.fit2.T)#
det.fit(bc.fit6.T)#
det.fit(bc.fit7.T)#
det.fit(bc.fit.fill.all.T)#
det.fit(bc.fit1.F)#
det.fit(bc.fit2.F)#
det.fit(bc.fit6.F)#
det.fit(bc.fit7.F)#
det.fit(bc.fit.fill.all.F)
log.fit
log.fit7.T
test<-fit.variogram(dummy.var1)
test<-fit.variogram(log.cloud)
test<-fit.variogram(v.log.cloud)
class(v.log.cloud)
bc.fit=fit.lmc(v.bc,g.bc,fit.lmc=FALSE)
det.fit(bc.fit)
bc.fit=fit.lmc(v.bc,g.bc,fit.lmc=FALSE,fit.sill=TRUE)
det.fit(bc.fit)
bc.fit=fit.lmc(v.bc,g.bc,fit.lmc=FALSE,fit.sill=FALSE)
det.fit(bc.fit)
bc.fit=fit.lmc(v.bc,g.bc,fit.sill=FALSE)
det.fit(bc.fit)
bc.fit
g.bc
plot(v.bc,bc.fit,main="fit.ranges=FALSE")
g.bc
det.fit(g.bc)
plot(v.bc,g.bc,main="fit.ranges=FALSE")
g.log = gstat(g.log,id=c("TP","FLOW"),maxdist=200)
g.log = gstat(g.log,id=c("TP","FLOW"))
g.log
g.log = gstat(NULL, "TP", log.spdf$TP ~ 1, log.spdf,,maxdist=200)
g.log = gstat(g.log, "FLOW", log.spdf$FLOW ~ 1, log.spdf,maxdist=200)
g.log
g.log = gstat(g.log,id="TP",model=vgm(log.tp.psill,"Sph",log.tp.range,log.tp.nug),maxdist=200)
g.log = gstat(g.log,id="FLOW",model=vgm(log.flow.psill,"Sph",log.flow.range,log.flow.nug),maxdist=200)
g.log
v.log.cloud = variogram(g.log,cloud=TRUE)
v.bc.cloud = variogram(g.bc,cloud=TRUE)
dummy.geodata<-as.geodata(data.log,coords.col=1:2,data.col=3)
dummy.var1<-variog(qual.tp.log,estimator.type="classical",option=c("cloud"))
dummy.var2<-variog(qual.tp.bc,estimator.type="classical",option=c("cloud"))
dummy.var1$u<-v.log.cloud$dist
dummy.var1$v<-v.log.cloud$gamma
dummy.var2$u<-v.bc.cloud$dist
dummy.var2$v<-v.bc.cloud$gamma
log<-variofit(dummy.var1,ini=c(0.5,0.5),cov.model="spherical",fix.nugget=F,max.dist=200,minimisation.function="nls")
bc<-variofit(dummy.var2,ini=c(0.5,27),cov.model="spherical", fix.nugget=F,minimisation.function="nls",weights="equal")
g.log = gstat(g.log,id=c("TP","FLOW"),maxdist=200)
g.log = gstat(g.log,id=c("TP","FLOW"),maxdist=200,model=vgm(summary(log)$spatial.component[[1]][1], "Sph", log$practicalRange, log$nugget))
g.log
g.log.fill.all = gstat(g.log,id=c("TP","FLOW"),model=vgm(summary(log)$spatial.component[[1]][1], "Sph", log$practicalRange, log$nugget),fill.all=TRUE,,maxdist=200)
g.log.fill.all
log.fit=fit.lmc(v.log,g.log)
log.fit7.T = fit.lmc(v.log, g.log,fit.ranges=TRUE,fit.lmc=FALSE,fit.method=7,warn.if.neg=TRUE)
log.fit7.T = fit.lmc(v.log, g.log,fit.ranges=TRUE,fit.lmc=FALSE,fit.method=7,warn.if.neg=TRUE)
det.fit(log.fit)
det.fit(log.fit.fill.all.T)
det.fit(log.fit7.T)
g.bc = gstat(g.bc,id=c("TP","FLOW"),model=vgm(summary(bc)$spatial.component[[1]][1], "Sph", bc$practicalRange, bc$nugget),,maxdist=200)#
g.bc.fill.all = gstat(g.bc,id=c("TP","FLOW"),model=vgm(summary(bc)$spatial.component[[1]][1], "Sph", bc$practicalRange, bc$nugget),fill.all=TRUE,,maxdist=200)
bc.fit=fit.lmc(v.bc,g.bc)
det.fit(bc.fit)
det.fit(bc.fit.fill.all.T)
det.fit(bc.fit7.T)
